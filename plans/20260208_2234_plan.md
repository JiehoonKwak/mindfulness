# Fix: Mobile Safari audio blocked on Meditate page

## Context

Mobile Safari requires `AudioContext` to be **created and resumed within a direct user gesture** (tap/click handler). On the Meditate page, audio playback is broken because:

```
User taps Start → status="countdown" → 3s countdown → status="running"
                                                         ↓
                                          useEffect fires audio.addAmbient()
                                          → creates AudioContext (NOT in gesture context)
                                          → Safari BLOCKS it
```

Settings page works because it uses `new Audio(url).play()` directly inside button `onClick` handlers — within gesture context.

## Fix

Add early AudioContext initialization via user gesture listener in `useAudioLayers` — the same pattern already used in `useAudio.ts:88-101`.

### File: `frontend/src/hooks/useAudioLayers.ts`

Add a `useEffect` that registers `touchstart`/`click` listeners to call `getContext()` on first interaction. This unlocks the AudioContext within the user's Start tap, so by the time the countdown finishes and the useEffect triggers `addAmbient()`, the context is already in "running" state.

```ts
// After the cleanup useEffect (~line 325), add:
useEffect(() => {
  const handleInteraction = () => {
    getContext();
  };
  document.addEventListener("touchstart", handleInteraction, { once: true });
  document.addEventListener("click", handleInteraction, { once: true });
  return () => {
    document.removeEventListener("touchstart", handleInteraction);
    document.removeEventListener("click", handleInteraction);
  };
}, [getContext]);
```

**No other files need changes.** This follows the existing pattern in `useAudio.ts` and requires zero prop threading.

## Why this works

1. Meditate page mounts → `useAudioLayers()` registers listeners
2. User taps Start button → `touchstart`/`click` fires → `getContext()` creates AudioContext + calls `resume()` — all within user gesture
3. 3 seconds later, countdown ends → `status="running"` → useEffect calls `addAmbient()` → AudioContext already exists and is running

## Verification

1. `cd frontend && bun run build` — type check passes
2. Test on iOS Safari: navigate to /meditate, set default ambient in settings, start timer, confirm audio plays after countdown
3. Test desktop still works (no regression)

